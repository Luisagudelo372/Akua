{% extends 'core/base.html' %}
{% load static %}

{% block title %}{{ place.name }} - Akua{% endblock %}

{% block content %}
<!-- Hero Section con Foto -->
<div class="position-relative" style="height: 400px; overflow: hidden;">
  {% if place.photo %}
  <img src="{{ place.photo.url }}" alt="{{ place.name }}" 
       class="w-100 h-100" style="object-fit: cover;">
  {% else %}
  <div class="bg-light w-100 h-100 d-flex align-items-center justify-content-center">
    <i class="bi bi-image text-muted" style="font-size: 5rem;"></i>
  </div>
  {% endif %}
  
  <div class="position-absolute top-0 start-0 w-100 h-100" 
       style="background: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.6));"></div>
  
  <div class="position-absolute bottom-0 start-0 w-100 p-4 text-white">
    <div class="container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb mb-2">
          <li class="breadcrumb-item"><a href="{% url 'places' %}" class="text-white">Lugares</a></li>
          <li class="breadcrumb-item active text-white" aria-current="page">{{ place.name }}</li>
        </ol>
      </nav>
      <h1 class="display-4 fw-bold mb-2">{{ place.name }}</h1>
      {% if place.city or place.department %}
      <p class="lead mb-0">
        <i class="bi bi-pin-map-fill"></i>
        {% if place.city %}{{ place.city }}{% endif %}
        {% if place.city and place.department %}, {% endif %}
        {% if place.department %}{{ place.department }}{% endif %}
      </p>
      {% endif %}
    </div>
  </div>
</div>

<!-- Información Principal -->
<div class="container py-5">
  <div class="row">
    <!-- Columna Principal -->
    <div class="col-lg-8">
      <!-- Descripción -->
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body p-4">
          <h3 class="fw-bold mb-3">
            <i class="bi bi-info-circle-fill text-primary me-2"></i>
            Sobre este lugar
          </h3>
          <p class="lead text-muted">{{ place.short_description }}</p>
        </div>
      </div>

      <!-- Eventos -->
      {% if place.events %}
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body p-4">
          <h4 class="fw-bold mb-3">
            <i class="bi bi-calendar-event-fill text-success me-2"></i>
            Eventos
          </h4>
          <p class="mb-0">{{ place.events }}</p>
        </div>
      </div>
      {% endif %}

      <!-- Restaurantes -->
      {% if place.restaurants %}
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body p-4">
          <h4 class="fw-bold mb-3">
            <i class="bi bi-shop-window text-danger me-2"></i>
            Restaurantes Recomendados
          </h4>
          <p class="mb-0">{{ place.restaurants }}</p>
        </div>
      </div>
      {% endif %}

      <!-- Hoteles -->
      {% if place.hotels %}
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body p-4">
          <h4 class="fw-bold mb-3">
            <i class="bi bi-building text-info me-2"></i>
            Dónde Hospedarse
          </h4>
          <p class="mb-0">{{ place.hotels }}</p>
        </div>
      </div>
      {% endif %}
    </div>

    <!-- Sidebar -->
    <div class="col-lg-4">
      <!-- Info Rápida -->
      <div class="card border-0 shadow-sm mb-4 sticky-top" style="top: 100px;">
        <div class="card-body p-4">
          <h5 class="fw-bold mb-4">Información del Viaje</h5>
          
          <!-- Rating -->
          {% if place.rating_average > 0 %}
          <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom">
            <span class="text-muted">
              <i class="bi bi-star-fill text-warning"></i> Calificación
            </span>
            <span class="fw-bold fs-5">{{ place.rating_average }}/5.0</span>
          </div>
          {% endif %}

          <!-- Costo -->
          {% if place.estimated_cost > 0 %}
          <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom">
            <span class="text-muted">
              <i class="bi bi-cash-coin text-success"></i> Costo Estimado
            </span>
            <span class="fw-bold text-success">${{ place.estimated_cost|floatformat:0 }}</span>
          </div>
          {% endif %}

          <!-- Categoría -->
          {% if place.category %}
          <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom">
            <span class="text-muted">
              <i class="bi bi-tag"></i> Categoría
            </span>
            <span class="badge bg-light text-dark border">{{ place.category }}</span>
          </div>
          {% endif %}

          <!-- Botones de Acción -->
          <div class="d-grid gap-2 mt-4">
            {% if user.is_authenticated %}
            <a href="{% url 'donde_ir' %}" class="btn btn-akua">
              <i class="bi bi-map"></i> Planear Viaje
            </a>
            {% else %}
            <a href="{% url 'login' %}" class="btn btn-akua">
              <i class="bi bi-box-arrow-in-right"></i> Inicia sesión para planear
            </a>
            {% endif %}
            
            <a href="{% url 'places' %}" class="btn btn-outline-secondary">
              <i class="bi bi-arrow-left"></i> Volver a Lugares
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .btn-akua {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
  }
  
  .btn-akua:hover {
    background: linear-gradient(135deg, #5568d3 0%, #63408a 100%);
    color: white;
  }
  
  .breadcrumb-item + .breadcrumb-item::before {
    color: rgba(255, 255, 255, 0.7);
  }
</style>
{% endblock %}